<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Relatórios</title>

  <<link href="../boostrap/CSS/bootstrap.min.css" rel="stylesheet">
  <script src="../boostrap/JS/bootstrap.bundle.min.js"></script>
  <link href="../boostrap/CSS/bootstrap-icons.css" rel="stylesheet">
  <script src="../boostrap/JS/jquery.min.js"></script>
  <link rel="stylesheet" href="../assets/styles/relatorios.css">
</head>

<body>
<div id="overlay" onclick="closeMobileSidebar()"></div>
<button id="mobile-toggle" onclick="toggleSidebar()">
 <i><img src="../assets/img/menu.png"></i>
</button>
<div id="sidebar" style="background-color: #4C8F5A;">
 <div>
   <button class="toggle-btn" onclick="toggleSidebar()">
     <img src="../assets/img/SIMBOLO.png" alt="SACC">
     <span class="brand-text">SACC</span>
   </button>
   <ul class="nav flex-column">
     <li><a href="admin-dashboard.php"><i><img src="../assets/img/dashboard.png" class="dashboard"></i> <span class="label-text">Dashboard</span></a></li>
    <li><a href="admin-escolas.php"><i><img src="../assets/img/escola.png" class="escola"></i> <span class="label-text">Escolas</span></a></li>
    <li><a href="admin-trabalhos.php"><i><img src="../assets/img/trabalho.png" class="trabalho"></i> <span class="label-text">Trabalhos</span></a></li>
    <li><a href="admin-jurados.php"><i><img src="../assets/img/Jurados.png" class="jurado"></i> <span class="label-text">Jurados</span></a></li>
    <li><a href="admin-relatorios.html"><i><img src="../assets/img/relatorio.png" class="relatorio"></i> <span class="label-text">Relatórios</span></a></li>
   </ul>
 </div>
 <ul class="nav flex-column bottom-nav">
   <li><a href="../php/AdmLogout.php"><img src="../assets/img/sair.png" class="sair"> <span class="label-text">Sair</span></a></li>
 </ul>
</div>
<main id="main">
 <h2>Relatórios de Trabalhos</h2>
 <br>
 <hr><br>
 
 <div class="filter-group">
   <select id="schoolFilter">
     <option value="">Selecione a Escola</option>
     <option value="EEEP Francisco Paiva Tavares">EEEP Francisco Paiva Tavares</option>
     <option value="EEEP Jose Vidal Alves">EEEP Jose Vidal Alves</option>
     <option value="EEM Casemiro Bezerra de Araújo">EEM Casemiro Bezerra de Araújo</option>
   </select>
   <select id="categoryFilter">
     <option value="">Selecione a Categoria</option>
     <option value="I">Ensino Médio</option>
     <option value="II">Ensino Médio - Ações Afirmativas e CEJAs EM</option>
     <option value="III">Pesquisa Júnior</option>
     <option value="IV">PcD</option>
   </select>
   <select id="areaFilter">
     <option value="">Selecione a Área</option>
   </select>
 </div>

 <div class="report-buttons">
   <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#modalJurado" style="background-color: #4C8F5A;">Por Jurado</button>
   <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#modalAmbosJurados" style="background-color: #4C8F5A;">Ambos os Jurados</button>
   <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#modalPorEscola" style="background-color: #4C8F5A;">Por Escola</button>
   <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#modalRanking" style="background-color: #4C8F5A;">Ranking</button>
 </div>

 
     <br>
 <!-- Tabela de trabalhos -->
 <table class="table table-striped" id="workTable">
   <thead class=" table-success">
     <tr class="tr">
       <th class="th">Título do Trabalho</th>
       <th class="th">Escola</th>
       <th class="th">Categoria</th>
       <th class="th">Área</th>
       <th class="th">Download</th>
     </tr>
   </thead>
   <tbody>

   </tbody>
 </table>

<div class="modal fade" id="modalJurado" tabindex="-1" aria-labelledby="modalJuradoLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalJuradoLabel">Relatório Por Jurado</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
            </div>
            <div class="modal-body">
              <form method="POST" action="#" id="idSelJurado">
                <label for="jurado-nome" class="form-label">Nome do Jurado</label>
                <select id="jurado-nome" class="form-control" name="nome" required>
                  <option value="">Selecione o Jurado</option>
                  <option value="jurado1">Jurado 1</option>
                  <option value="jurado2">Jurado 2</option>
                  <option value="jurado3">Jurado 3</option>
                </select>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="margin-top: 17px;">Fechar</button>
              <button type="button" class="btn btn-success mt-3">Gerar Relatório</button>
            </div>
          </div>
        </div>
      </div>



<div class="modal fade" id="modalAmbosJurados" tabindex="-1" aria-labelledby="modalAmbosJuradosLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalAmbosJuradosLabel">Relatório por Ambos os Jurados</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <p>Gerar relatório dos trabalhos avaliados por ambos os jurados.</p>

        <label for="categoria-Ambos" class="form-label">Categoria</label>
        <select id="categoria-Ambos" class="form-select mb-2" name="categoria">
          <option value="">Selecione a Categoria</option>
          <option value="1">Ensino Médio</option>
          <option value="2">Ensino Médio - Ações Afirmativas e CEJAs EM</option>
          <option value="3">Pesquisa Júnior</option>
          <option value="4">PcD</option>
        </select>
        <div id="area-Ambos" style="display: none;">
          <label for="area-Ambos" class="form-label">Área</label>
        <select class="form-select">
          <option value="">Selecione a Área</option>
          <option value="1">Linguagens, Códigos e suas Tecnologias - LC</option>
          <option value="2">Matemática e suas Tecnologias - MT</option>
          <option value="3">Ciências da Natureza, Educação Ambiental e Engenharias - CN</option>
          <option value="4">Ciências Humanas e Sociais Aplicadas - CH</option>
          <option value="5">Robótica, Automação e Aplicação das TIC</option>
        </select>
        </div>
        <div id="area-Ambos2" style="display: none;">
          <label for="area-Ambos2" class="form-label">Área</label>
        <select class="form-select" >
          <option value="">Selecione a Área</option>
          <option value="1">Ensino Fundamental</option>
          <option value="2">Ensino Médio</option>
        </select>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="margin-top: 17px;">Fechar</button>
        <button type="button" class="btn btn-success mt-3">Gerar Relatório</button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="modalPorEscola" tabindex="-1" aria-labelledby="modalPorEscolaLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalPorEscolaLabel">Relatório por Escola</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <p>Gerar relatório dos trabalhos submetidos por uma escola específica.</p>

        <label for="escolaSelect" class="form-label">Escola</label>
        <select id="escolaSelect" class="form-select">
          <option value="">Selecione a Escola</option>
          <option value="EEEP Francisco Paiva Tavares">EEEP Francisco Paiva Tavares</option>
          <option value="EEEP Jose Vidal Alves">EEEP Jose Vidal Alves</option>
          <option value="EEM Casemiro Bezerra de Araújo">EEM Casemiro Bezerra de Araújo</option>
        </select>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="margin-top: 17px;">Fechar</button>
        <button type="button" class="btn btn-success mt-3">Gerar Relatório</button>
      </div>
    </div>
  </div>
</div>


<!-- Modal Ranking - CORRIGIDO E ADICIONADO SELECTS -->
<div class="modal fade" id="modalRanking" tabindex="-1" aria-labelledby="modalRankingLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalRankingLabel">Ranking de Trabalhos</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <div class="modal-body">
        <p>Gerar relatório de classificação dos trabalhos.</p>

        <label for="categoria-Ranking" class="form-label">Categoria</label>
        <select id="categoria-Ranking" class="form-select mb-2">
          <option value="">Selecione a Categoria</option>
          <option value="1">Ensino Médio</option>
          <option value="2">Ensino Médio - Ações Afirmativas e CEJAs EM</option>
          <option value="3">Pesquisa Júnior</option>
          <option value="4">PcD</option>
        </select>
  
        <div id="area-Ranking" style="display: none;">
          <label for="area-Ranking" class="form-label">Área</label>
          <select class="form-select">
            <option value="">Selecione a Área</option>
            <option value="1">Linguagens, Códigos e suas Tecnologias - LC</option>
            <option value="2">Matemática e suas Tecnologias - MT</option>
            <option value="3">Ciências da Natureza, Educação Ambiental e Engenharias - CN</option>
            <option value="4">Ciências Humanas e Sociais Aplicadas - CH</option>
            <option value="5">Robótica, Automação e Aplicação das TIC</option>
        </select>
        </div>
        <div id="area-Ranking2" style="display: none;">
          <label for="area-Ranking2" class="form-label">Área</label>
          <select class="form-select">
            <option value="">Selecione a Área</option>
            <option value="1">Ensino Fundamental</option>
            <option value="2">Ensino Médio</option>
          </select>
      </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="margin-top: 17px;">Fechar</button>
        <button type="button" class="btn btn-success mt-3">Gerar Relatório</button>
      </div>
    </div>
  </div>
</div>

</main>
<script src="../bootstrap/JS/jquery.min.js"></script>
<script>

$('#categoria-Ambos').change(function () {
  var categoria = $(this).val();
  if (categoria === '1' || categoria === '2') {
    $('#area-Ambos').slideDown();
    $('#area-Ambos2').slideUp();
  } else if (categoria === '4') {
    $('#area-Ambos').slideUp();
    $('#area-Ambos2').slideDown();
  } else if (categoria === '3') {
    $('#area-Ambos, #area-Ambos2').slideUp();
  }
});

$('#categoria-Ranking').change(function () {
  var categoria = $(this).val();
  if (categoria === '1' || categoria === '2') {
    $ ('#area-Ranking').slideDown();
    $('#area-Ranking2').slideUp();
  } else if (categoria === '4') {
    $('#area-Ranking').slideUp();
    $('#area-Ranking2').slideDown();
  } else if (categoria === '3') {
    $('#area-Ranking, #area-Ranking2').slideUp();
  }
});

// SIDEBAR
function toggleSidebar(){
 if(window.innerWidth <= 768){
   $('#sidebar').toggleClass('mobile-open');
   $('#overlay').toggleClass('show');
 } else {
   $('#sidebar').toggleClass('collapsed');
   $('#main').toggleClass('collapsed');
 }
}
function closeMobileSidebar(){
 $('#sidebar').removeClass('mobile-open');
 $('#overlay').removeClass('show');
}
$(window).on('resize', function(){
 if(window.innerWidth > 768){
   $('#sidebar').removeClass('mobile-open');
   $('#overlay').removeClass('show');
 }
});


// Dados de exemplo
const works = [
 {title:"Trabalho LM", school:"EEEP Francisco Paiva Tavares", category:"Ensino Médio", area:"Linguagens, Códigos e suas Tecnologias - LC"},
 {title:"Trabalho MT1", school:"EEEP Francisco Paiva Tavares", category:"Ensino Médio", area:"Matemática e suas Tecnologias - MT"},
 {title:"Trabalho CN1", school:"EEEP José Vidal Alves", category:"Ensino Médio", area:"Ciências da Natureza - CN"},
 {title:"Trabalho CH1", school:"EEM Casemiro Bezerra de Araújo", category:"Ensino Médio", area:"Educação Ambiental e Engenharias - CH"},
 {title:"Trabalho ROB1", school:"EEEP Francisco Paiva Tavares", category:"Ensino Médio", area:"Robótica, Automação e Aplicação das TIC"},
 {title:"Trabalho LM2", school:"EEEP José Vidal Alves", category:"Ensino Médio - Ações Afirmativas e CEJAs EM", area:"Linguagens, Códigos e suas Tecnologias - LC"},
 {title:"Trabalho MT2", school:"EEEP Francisco Paiva Tavares", category:"Ensino Médio - Ações Afirmativas e CEJAs EM", area:"Matemática e suas Tecnologias - MT"},
 {title:"Trabalho CN2", school:"EEM Casemiro Bezerra de Araújo", category:"Ensino Médio - Ações Afirmativas e CEJAs EM", area:"Ciências da Natureza - CN"},
 {title:"Trabalho CH2", school:"EEEP Francisco Paiva Tavares", category:"Ensino Médio - Ações Afirmativas e CEJAs EM", area:"Educação Ambiental e Engenharias - CH"},
 {title:"Trabalho ROB2", school:"EEEP José Vidal Alves", category:"Ensino Médio - Ações Afirmativas e CEJAs EM", area:"Robótica, Automação e Aplicação das TIC"},
 {title:"Pesquisa Jr1", school:"EEEP Francisco Paiva Tavares", category:"Pesquisa Júnior", area:""},
 {title:"Pesquisa Jr2", school:"EEEP José Vidal Alves", category:"Pesquisa Júnior", area:""},
 {title:"Pesquisa Jr3", school:"EEM Casemiro Bezerra de Araújo", category:"Pesquisa Júnior", area:""},
 {title:"Pesquisa Jr4", school:"EEEP Francisco Paiva Tavares", category:"Pesquisa Júnior", area:""},
 {title:"Pesquisa Jr5", school:"EEEP José Vidal Alves", category:"Pesquisa Júnior", area:""},
 {title:"PcD EF1", school:"EEEP Francisco Paiva Tavares", category:"PcD", area:"Ensino Fundamental"},
 {title:"PcD EF2", school:"EEEP Jose Vidal Alves", category:"PcD", area:"Ensino Fundamental"},
 {title:"PcD EM1", school:"EEM Casemiro Bezerra de Araújo", category:"PcD", area:"Ensino Médio"},
 {title:"PcD EM2", school:"EEEP Francisco Paiva Tavares", category:"PcD", area:"Ensino Médio"},
 {title:"PcD EM3", school:"EEEP José Vidal Alves", category:"PcD", area:"Ensino Médio"}
];


// Áreas por categoria
const areas = {
 "I": ["Linguagens, Códigos e suas Tecnologias - LC", "Matemática e suas Tecnologias - MT", "Ciências da Natureza - CN", "Educação Ambiental e Engenharias - CH", "Robótica, Automação e Aplicação das TIC"],
 "II": ["Linguagens, Códigos e suas Tecnologias - LC", "Matemática e suas Tecnologias - MT", "Ciências da Natureza - CN", "Educação Ambiental e Engenharias - CH", "Robótica, Automação e Aplicação das TIC"],
 "III": [],
 "IV": ["Ensino Fundamental", "Ensino Médio"]
};


// Preencher área ao escolher categoria
$('#categoryFilter').on('change', function(){
 const cat = $(this).val();
 const areaSelect = $('#areaFilter');
 areaSelect.html('<option value="">Selecione a Área</option>');
 if(areas[cat]){
   areas[cat].forEach(a => {
     areaSelect.append(`<option value="${a}">${a}</option>`);
   });
 }
 filterWorks();
});


// Filtrar ao alterar filtros
$('#schoolFilter, #areaFilter').on('change', filterWorks);


function filterWorks(){
 const school = $('#schoolFilter').val();
 const categoryVal = $('#categoryFilter').val();
 const categoryName = $('#categoryFilter option:selected').text();
 const area = $('#areaFilter').val();


 const filtered = works.filter(w=>{
   return (!school || w.school===school) &&
          (!categoryVal || w.category===categoryName) &&
          (!area || w.area===area);
 });


 const tbody = $('#workTable tbody');
 tbody.empty();
 filtered.forEach(w=>{
   tbody.append(`
     <tr>
       <td>${w.title}</td>
       <td>${w.school}</td>
       <td>${w.category}</td>
       <td>${w.area || '-'}</td>
       <td style="text-align: center;"><span><i><img src="../assets/img/dowload.svg"></i></span></td>
     </tr>
   `);
 });
}


// Inicializa tabela
filterWorks();
</script>
</body>
</html>
